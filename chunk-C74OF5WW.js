import{a as A,c as D,g as W,l as G,m as j,n as z,q}from"./chunk-47M35D6R.js";import{a as K,b as Q}from"./chunk-EJDH7DDO.js";import{a as J}from"./chunk-62Y5HVUV.js";import{a as H}from"./chunk-TWOJGJXD.js";import{D as v,F as p,G as L,H as r,I as o,J as _,K as C,L as f,M as m,O as c,P as u,Q as E,S,T as x,U as b,W as V,X as I,c as w,ca as T,da as U,ea as B,f as N,l as y,o as F,oa as R,p as h,pa as k,s as d,t as g,y as s,z as O}from"./chunk-XDOW7T3A.js";var $=()=>["/user/company-profile"],ee=n=>({id:n});function te(n,t){if(n&1&&(r(0,"option",14),c(1),o()),n&2){let e=t.$implicit;p("value",e._id),s(),u(e.name)}}function ie(n,t){if(n&1){let e=C();r(0,"div")(1,"label",12),c(2,"Service Type"),o(),r(3,"select",13),b("ngModelChange",function(a){d(e);let l=m();return x(l.filterService,a)||(l.filterService=a),g(a)}),_(4,"option",14),v(5,te,2,2,"option",15),o(),_(6,"br"),r(7,"label",16),c(8,"Rating"),o(),r(9,"select",17),b("ngModelChange",function(a){d(e);let l=m();return x(l.filterRating,a)||(l.filterRating=a),g(a)}),_(10,"option",14),r(11,"option",14),c(12),o(),r(13,"option",14),c(14),o(),r(15,"option",14),c(16),o(),r(17,"option",14),c(18),o(),r(19,"option",14),c(20),o()(),_(21,"br"),r(22,"button",18),f("click",function(){d(e);let a=m();return g(a.filter())}),c(23,"Apply"),o(),r(24,"button",19),f("click",function(){d(e);let a=m();return g(a.nofilter())}),c(25,"No Filter"),o()()}if(n&2){let e=m();s(3),S("ngModel",e.filterService),s(2),p("ngForOf",e.services),s(4),S("ngModel",e.filterRating),s(2),p("value",1),s(),u(1),s(),p("value",2),s(),u(2),s(),p("value",3),s(),u(3),s(),p("value",4),s(),u(4),s(),p("value",5),s(),u(5)}}function ne(n,t){if(n&1){let e=C();r(0,"span",21),f("click",function(){d(e);let a=m(2);return g(a.onSort("companyName"))}),c(1,"\u25B2"),o()}}function re(n,t){if(n&1){let e=C();r(0,"span",21),f("click",function(){d(e);let a=m(2);return g(a.onSort("companyName"))}),c(1,"\u25BC"),o()}}function oe(n,t){if(n&1&&(r(0,"span"),v(1,ne,2,0,"span",20)(2,re,2,0,"span",20),o()),n&2){let e=m();s(),p("ngIf",e.sortOrder==="asce"),s(),p("ngIf",e.sortOrder==="desc")}}function ae(n,t){if(n&1){let e=C();r(0,"tr")(1,"td"),c(2),o(),r(3,"td"),c(4),o(),r(5,"td")(6,"button",22),f("click",function(){d(e);let a=m();return g(a.toViewpage())}),c(7," View "),o()()()}if(n&2){let e=t.$implicit,i=m();s(2),u(e.companyName),s(2),u(i.getServiceName(e.serviceType)),s(2),p("routerLink",V(4,$))("queryParams",I(5,ee,e._id))}}function se(n,t){if(n&1){let e=C();r(0,"button",21),f("click",function(){let a=d(e).$implicit,l=m();return g(l.onPageClick(a))}),c(1),o()}if(n&2){let e=t.$implicit,i=m();L("active",e===i.currentPage),s(),E(" ",e," ")}}var P=class n{constructor(t,e){this.apiService=t;this.service=e}filterByCompany=[];isFilter=!1;rating=0;filterRating=" ";filterService=" ";filterCompanyName=null;filterData=[];services=[];getServiceProviders=[];getService={_id:"",name:""};serviceProvider=[];totalPages=3;pageSize=10;currentPage=1;pages=[];sortOrder="asce";sortColumn="companyName";ngOnInit(){try{this.getAllCompaines(),this.generatePages(),this.getCompaines(),this.getServices()}catch(t){console.log(t)}}generatePages(){try{this.pages=Array.from({length:this.totalPages},(t,e)=>e+1)}catch(t){console.log(t)}}onPageClick(t){try{this.currentPage=t,this.getCompaines()}catch(e){console.log(e)}}onSort(t){try{this.sortColumn===t?this.sortOrder=this.sortOrder==="asce"?"desc":"asce":(this.sortColumn=t,this.sortOrder="asce"),this.getCompaines()}catch(e){console.log(e)}}getCompaines(){try{let t={pageNumber:this.currentPage.toString(),pageSize:"10"},e={sortBy:this.sortColumn,sortOrder:this.sortOrder};this.apiService.getServiceProviders(t,e).subscribe(i=>{console.log(i.data),this.getServiceProviders=i.data,this.serviceProvider=i.data})}catch(t){console.log(t)}}getAllCompaines(){try{let t={pageNumber:"0",pageSize:"0"},e={sortBy:this.sortColumn,sortOrder:this.sortOrder};this.apiService.getServiceProviders(t,e).subscribe(i=>{console.log(i.data),this.service.ServiceProviders=i.data})}catch(t){console.log(t)}}getServiceName(t){try{let e="";t&&(e=t);let i="";for(let a of this.services)a._id===e&&(i=a.name);return console.log(i),i}catch(e){console.log(e)}}toViewpage(){}getServices(){try{this.apiService.getServices().subscribe(t=>{this.services=t.data})}catch(t){console.log(t)}}nofilter(){try{this.getServiceProviders=this.serviceProvider}catch(t){console.log(t)}}isFilterData(){try{this.isFilter=!0}catch(t){console.log(t)}}filter(){return w(this,null,function*(){try{if(this.filterData=[],this.filterService==" "&&this.filterRating==" ")this.filterData=this.serviceProvider,console.log(this.filterData);else{for(let t of this.serviceProvider)this.filterService!=" "&&t.serviceType==this.filterService&&this.filterRating!=" "&&(yield this.getFeedBack(t._id))==this.filterRating?this.filterData.push(t):(this.filterService!=" "&&t.serviceType==this.filterService||this.filterRating!=" "&&(yield this.getFeedBack(t._id))==this.filterRating)&&this.filterData.push(t);console.log(this.filterData),this.getServiceProviders=this.filterData}}catch(t){console.log(t)}})}getFeedBack(t){return w(this,null,function*(){try{let e=0,i,a="";t&&(a=t);try{let Z=(yield N(this.apiService.getServiceProviderFeedBack(a))).data;return i=this.companyRating(Z),i!=null&&(e=i),console.log(e),e}catch(l){throw console.error(l),l}}catch(e){console.log(e)}})}companyRating(t){try{if(t.length>0){let e=0;for(let i of t)e+=i.rating;return e=e/t.length,console.log(e),e>=0&&e<=1?e=1:e>1&&e<=2?e=2:e>2&&e<=3?e=3:e>3&&e<=4?e=4:e>4&&e<=5&&(e=5),console.log(e),e}else console.log("No feedbacks available to calculate the rating.");return 0}catch(e){console.log(e)}}search(){try{this.filterByCompany=[];let t="";this.filterCompanyName!=null&&(t=this.filterCompanyName);for(let e of this.serviceProvider)e.companyName&&this.searchWordInString(t,e.companyName)&&this.filterByCompany.push(e);this.getServiceProviders=this.filterByCompany,console.log(this.filterByCompany,"filterBucompany")}catch(t){console.log(t)}}searchWordInString(t,e){try{return e.toLowerCase().includes(t.toLowerCase())}catch(i){console.log(i)}}static \u0275fac=function(e){return new(e||n)(O(J),O(H))};static \u0275cmp=F({type:n,selectors:[["app-user-companies-list"]],decls:27,vars:5,consts:[[1,"user-companies"],[1,"sidenav"],[1,"user-companies-page"],[1,"search-container"],["type","text","id","companyName","name","companyName",3,"ngModelChange","ngModel"],["type","button",1,"searchButton",3,"click"],[1,"filter"],["type","button",1,"filterButton",3,"click"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"pagination"],[3,"active","click",4,"ngFor","ngForOf"],["for","serviceType"],["id","serviceType",3,"ngModelChange","ngModel"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["for","rating"],["id","rating",3,"ngModelChange","ngModel"],["type","button",3,"click"],["type","button",1,"noFilterbutton",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["type","button",3,"click","routerLink","queryParams"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1),_(2,"app-userside-nav"),o(),r(3,"div",2)(4,"div",3)(5,"input",4),b("ngModelChange",function(l){return x(i.filterCompanyName,l)||(i.filterCompanyName=l),l}),o(),r(6,"button",5),f("click",function(){return i.search()}),c(7,"SEARCH"),o()(),r(8,"div",6)(9,"button",7),f("click",function(){return i.isFilterData()}),c(10,"Filter"),o(),v(11,ie,26,13,"div",8),o(),r(12,"table")(13,"thead")(14,"tr")(15,"th"),c(16," Company Details "),v(17,oe,3,2,"span",8),o(),r(18,"th"),c(19,"Service Type"),o(),r(20,"th"),c(21,"View"),o()()(),r(22,"tbody"),v(23,ae,8,7,"tr",9),o()(),r(24,"div")(25,"div",10),v(26,se,2,3,"button",11),o()()()()),e&2&&(s(5),S("ngModel",i.filterCompanyName),s(6),p("ngIf",i.isFilter),s(6),p("ngIf",i.sortColumn==="companyName"),s(6),p("ngForOf",i.getServiceProviders),s(3),p("ngForOf",i.pages))},dependencies:[T,U,R,K,j,z,A,G,D,W],styles:[".user-companies-page[_ngcontent-%COMP%]{margin-top:5%;padding:20px;flex-grow:1;overflow:auto}.filterButton[_ngcontent-%COMP%]{margin-left:10px}.searchButton[_ngcontent-%COMP%]{margin-left:90%}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:20px;text-align:left}thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#0288d1;color:#fff;padding:10px;text-align:left}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;border-bottom:1px solid #ddd}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{text-align:left}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:20px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 5px;padding:5px 10px;border:none;border-radius:4px;background-color:#0288d1;color:#fff;cursor:pointer;transition:background-color .3s ease}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%], .pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0277bd}input[type=text][_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:calc(100% - 20px);padding:10px;margin:10px 0;border:1px solid #b3e5fc;border-radius:16px;font-size:14px}button[_ngcontent-%COMP%]{background-color:#0288d1;color:#fff;border:none;padding:10px 15px;border-radius:4px;font-size:14px;cursor:pointer;transition:background-color .3s ease}button[_ngcontent-%COMP%]:hover{background-color:#0277bd}.noFilterbutton[_ngcontent-%COMP%]{margin-left:90%}"]})};var ce=[{path:"",component:P}],M=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=h({type:n});static \u0275inj=y({imports:[k.forChild(ce),k]})};var Y=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=h({type:n});static \u0275inj=y({imports:[B,M,Q,q]})};export{Y as UserCompaniesListModule};
